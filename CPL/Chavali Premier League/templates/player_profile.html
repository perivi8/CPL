<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>Player Profile</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">

    <style>
        .red { background-color: red !important; color: white !important; }
        .yellow { background-color: yellow !important; color: black !important; }
        .orange { background-color: orange !important; color: white !important; }

        .bid-box {
            border: 2px solid #ccc;
            padding: 15px;
            border-radius: 8px;
            background-color: #f9f9f9;
            text-align: center;
            margin-top: 20px;
            transition: all 0.3s ease;
        }

        .bid-points {
            font-size: 2rem;
            font-weight: bold;
        }

        /* Animation */
        .animate {
            animation: pulse 0.5s;
        }

        @keyframes pulse {
            0% { transform: scale(1); opacity: 0.7; }
            50% { transform: scale(1.1); opacity: 1; }
            100% { transform: scale(1); opacity: 1; }
        }
    </style>
</head>

<body class="bg-light">

    <div class="container mt-5">

        <div class="card shadow">
            <div class="card-body">

                <h1 class="card-title text-center mb-4">{{ player.name }} - Bidding</h1>
                <p class="text-center text-muted">Player ID: {{ player.player_id }}</p>

                <h4>Click to Bid:</h4>

                <form id="bidForm" method="POST" action="{{ url_for('assign_player') }}">
                    <input type="hidden" name="player_id" value="{{ player.player_id }}">
                    <input type="hidden" id="team_color_input" name="team_color">
                    <input type="hidden" id="bid_points_input" name="bid_points">

                    <div class="d-flex flex-wrap gap-2">
                        {% for team in teams %}
                            <button type="button" class="btn {{ team.color }} flex-fill" onclick="selectTeam('{{ team.color }}')">{{ team.team_name }}</button>
                        {% endfor %}
                    </div>

                    <!-- Animated Bid Display -->
                    <div class="bid-box mt-4">
                        <div>Current Bid</div>
                        <div id="bidStatus" class="bid-points text-secondary">No Bid Yet</div>
                    </div>

                    <div class="d-grid gap-2 mt-4">
                        <button type="submit" class="btn btn-success btn-lg">Confirm Bid</button>
                    </div>
                </form>

                <hr>

                <!-- No Bid Button -->
                <form method="POST" action="{{ url_for('no_bid') }}" class="text-center">
                    <input type="hidden" name="player_id" value="{{ player.player_id }}">
                    <button type="submit" class="btn btn-secondary">No Bid</button>
                </form>

                <br>

                <div class="text-center">
                    <a href="{{ url_for('player_list') }}" class="btn btn-outline-primary">Go Back</a>
                </div>

            </div>
        </div>

    </div>

    <!-- Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

    <script>
        let bidPoints = 0;

        function selectTeam(color) {
            bidPoints += 5;
            const bidStatus = document.getElementById('bidStatus');
            document.getElementById('team_color_input').value = color;
            document.getElementById('bid_points_input').value = bidPoints;

            bidStatus.innerHTML = bidPoints + " Points <br> by " + color + " team";
            bidStatus.style.color = color;

            // Trigger Animation
            bidStatus.classList.remove('animate');
            void bidStatus.offsetWidth; // Force reflow to restart animation
            bidStatus.classList.add('animate');
        }
    </script>

</body>

</html>
